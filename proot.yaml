metadata:
  name: proot-build-and-check
  format: "Lava-Test-Shell Test Definition 1.0"
  description: "Build and run PRoot test suite"
os:
  - ubuntu
devices:
  - kvm
install:
  git-repos:
    - https://github.com/cedric-vincent/PRoot
  deps:
    - build-essential
    - libtalloc-dev
run:
  steps:
    - cd PRoot
    - make -C src
    - make -C tests V=1
    - cd ..
parse:
  pattern: "^\\s*CHECK\\s+test-(?P<test_case_id>\\w+)\\s+(?P<result>(ok|skipped|FAILED))"
  fixupdict:
    ok: pass
    skipped: skip
    FAILED: fail
